<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Navaraa DApp</title>
  <link rel="icon" href="https://cryptologos.cc/logos/polygon-matic-logo.png" />
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <!-- Icons -->
  <link href="https://cdn.jsdelivr.net/npm/remixicon@4.3.0/fonts/remixicon.css" rel="stylesheet">
  <style>
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #0d0d0d, #1a0033, #0d0d0d);
      color: white;
      display: flex;
      flex-direction: column;
      height: 100vh;
    }
    header {
      padding: 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: rgba(0,0,0,0.5);
    }
    header h1 { margin: 0; font-size: 20px; display: flex; align-items: center; gap: 5px; }
    .btn {
      padding: 8px 15px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      background: #8247e5;
      color: white;
      font-weight: bold;
      transition: 0.3s;
    }
    .btn:hover { background: #5b2fbf; }
    main {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
    }
    .page { display: none; }
    .active { display: block; }
    .bottom-nav {
      display: flex;
      justify-content: space-around;
      background: rgba(0,0,0,0.7);
      padding: 10px 0;
      border-top: 1px solid #333;
    }
    .nav-item {
      text-align: center;
      flex: 1;
      cursor: pointer;
      color: #aaa;
      font-size: 14px;
    }
    .nav-item i {
      display: block;
      font-size: 22px;
      margin-bottom: 3px;
    }
    .nav-item.active { color: #fff; }
    .card {
      background: rgba(130,71,229,0.15);
      border-radius: 15px;
      padding: 15px;
      margin: 15px 0;
      box-shadow: 0 0 15px rgba(0,0,0,0.3);
    }
    .info {
      margin-top: 10px;
      padding: 10px;
      background: rgba(255,255,255,0.05);
      border-radius: 10px;
      font-size: 14px;
      word-break: break-word;
    }
  </style>
</head>
<body>
  <header>
    <h1><img src="https://cryptologos.cc/logos/polygon-matic-logo.png" width="24"/> Navaraa</h1>
    <button class="btn" id="connectBtn">Connect</button>
  </header>

  <main>
    <!-- Home Page -->
    <div id="home" class="page active">
      <h2>Welcome to Navaraa</h2>
      <p>Your gateway to Staking, Referral, SIP, Airdrop & Swap</p>
      <div class="card"><h3>About</h3><p>Navaraa is a next-gen crypto ecosystem.</p></div>
      <div id="walletInfo" class="info" style="display:none;"></div>
    </div>

    <!-- Swap Page -->
    <div id="swap" class="page">
      <h2>Swap</h2>
      <p>Coming soon: DEX Swap powered by Navaraa.</p>
      <div class="card"><h3>Token Swap</h3><p>Integration placeholder.</p></div>
    </div>

    <!-- Earn Page -->
    <div id="earn" class="page">
      <h2>Earn with Navaraa</h2>
      <div class="card"><h3>Staking</h3><p>Stake tokens and earn rewards.</p></div>
      <div class="card"><h3>Referral</h3><p>Invite friends and earn bonuses.</p></div>
      <div class="card"><h3>SIP</h3><p>Systematic Investment Plan in crypto.</p></div>
      <div class="card"><h3>Airdrop</h3><p>Exclusive community rewards.</p></div>
    </div>
  </main>

  <!-- Bottom Navigation -->
  <div class="bottom-nav">
    <div class="nav-item active" data-page="home"><i class="ri-home-5-fill"></i>Home</div>
    <div class="nav-item" data-page="swap"><i class="ri-exchange-dollar-fill"></i>Swap</div>
    <div class="nav-item" data-page="earn"><i class="ri-coins-fill"></i>Earn</div>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.min.js"></script>
  <!-- âœ… New WalletConnect + Web3Modal -->
  <script src="https://unpkg.com/@walletconnect/ethereum-provider@2.10.1/dist/index.umd.min.js"></script>
  <script src="https://unpkg.com/web3modal@1.9.12/dist/index.js"></script>

  <script>
    const connectBtn = document.getElementById("connectBtn");
    const walletInfo = document.getElementById("walletInfo");
    let provider, signer, userAddress;

    // Web3Modal setup
    const web3Modal = new window.Web3Modal.default({
      cacheProvider: false,
      providerOptions: {
        walletconnect: {
          package: window.WalletConnectProvider,
          options: {
            rpc: { 137: "https://polygon-rpc.com/" },
            chainId: 137
          }
        }
      }
    });

    async function connectWallet() {
      try {
        const instance = await web3Modal.connect();
        provider = new ethers.providers.Web3Provider(instance, "any");

        let network = await provider.getNetwork();
        if (network.chainId !== 137) {
          alert("Please switch to Polygon Network!");
          return;
        }

        signer = provider.getSigner();
        userAddress = await signer.getAddress();
        let balance = await provider.getBalance(userAddress);
        balance = ethers.utils.formatEther(balance);

        connectBtn.innerText = "Disconnect";
        walletInfo.style.display = "block";
        walletInfo.innerHTML = `
          <b>Address:</b> ${userAddress}<br>
          <b>Balance:</b> ${parseFloat(balance).toFixed(4)} MATIC<br>
          <b>Network:</b> Polygon
        `;
      } catch (err) {
        console.error(err);
        alert("Wallet connection failed!");
      }
    }

    function disconnectWallet() {
      provider = null;
      signer = null;
      userAddress = null;
      web3Modal.clearCachedProvider();
      connectBtn.innerText = "Connect";
      walletInfo.style.display = "none";
    }

    connectBtn.addEventListener("click", () => {
      if (userAddress) {
        disconnectWallet();
      } else {
        connectWallet();
      }
    });

    // Navigation
    const navItems = document.querySelectorAll(".nav-item");
    const pages = document.querySelectorAll(".page");
    function showPage(pageId) {
      pages.forEach(p => p.classList.remove("active"));
      document.getElementById(pageId).classList.add("active");
      navItems.forEach(n => n.classList.remove("active"));
      document.querySelector(`[data-page="${pageId}"]`).classList.add("active");
    }
    navItems.forEach(item => {
      item.addEventListener("click", () => {
        showPage(item.dataset.page);
        history.pushState({page: item.dataset.page}, "", `#${item.dataset.page}`);
      });
    });

    // Back button handling
    window.addEventListener("popstate", (e) => {
      if (e.state && e.state.page) {
        showPage(e.state.page);
      } else {
        showPage("home");
      }
    });
  </script>
</body>
</html>
